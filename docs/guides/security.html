<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>Security Best Practices — envctl Documentation</title>
    <meta name="title" content="Security Best Practices — envctl Documentation">
    <meta name="description" content="Security recommendations for envctl: passphrase strength, rotation schedules, least privilege access, backup and recovery, and incident response.">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://envctl.dev/docs/guides/security.html">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://envctl.dev/docs/guides/security.html">
    <meta property="og:title" content="Security Best Practices — envctl Documentation">
    <meta property="og:description" content="Security recommendations for using envctl.">
    <meta property="og:image" content="https://envctl.dev/og-image.png">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/logo-UeMDaNQG.svg">

    <!-- Theme -->
    <meta name="theme-color" content="#0a0a0b">
    <meta name="color-scheme" content="dark">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@400;500;600&display=swap">

    <link rel="stylesheet" href="/docs/docs.css">
  <link rel="stylesheet" crossorigin href="/assets/style-BhBew_en.css">
</head>
<body>
    <nav class="nav" role="navigation" aria-label="Main navigation">
        <a href="/" class="nav-logo" aria-label="envctl home">
            <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2032%2032'%20fill='none'%3e%3c!--%20Background%20circle%20--%3e%3ccircle%20cx='16'%20cy='16'%20r='15'%20stroke='%2322c55e'%20stroke-width='1.5'%20fill='none'/%3e%3c!--%20Lock%20body%20--%3e%3crect%20x='10'%20y='14'%20width='12'%20height='10'%20rx='2'%20fill='%2322c55e'/%3e%3c!--%20Lock%20shackle%20--%3e%3cpath%20d='M12%2014V11a4%204%200%200%201%208%200v3'%20stroke='%2322c55e'%20stroke-width='1.5'%20fill='none'%20stroke-linecap='round'/%3e%3c!--%20Keyhole%20--%3e%3ccircle%20cx='16'%20cy='18'%20r='1.5'%20fill='%230a0a0b'/%3e%3crect%20x='15'%20y='18'%20width='2'%20height='3'%20fill='%230a0a0b'/%3e%3c/svg%3e" alt="" width="32" height="32" aria-hidden="true">
            <span>envctl</span>
        </a>
        <div class="nav-links">
            <a href="/#features">Features</a>
            <a href="/#install">Install</a>
            <a href="/docs/" class="active">Docs</a>
            <a href="/#pricing">Pricing</a>
            <a href="https://github.com/uradical/envctl" class="nav-github" target="_blank" rel="noopener" aria-label="View on GitHub">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
            <button class="docs-mobile-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">
                <svg class="icon-menu" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
                <svg class="icon-close" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>
        </div>
    </nav>

    <div class="docs-sidebar-overlay" id="sidebarOverlay"></div>

    <div class="docs-layout">
        <aside class="docs-sidebar" id="docsSidebar">
            <div class="docs-sidebar-header">
                <h2>Documentation</h2>
                <button class="docs-sidebar-close" id="sidebarClose" aria-label="Close menu">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <nav class="docs-nav">
                <div class="docs-nav-section">
                    <h3>Getting Started</h3>
                    <ul>
                        <li><a href="/docs/">Documentation Home</a></li>
                        <li><a href="/docs/getting-started.html">Installation & Setup</a></li>
                        <li><a href="/docs/concepts.html">Core Concepts</a></li>
                    </ul>
                </div>

                <div class="docs-nav-section">
                    <h3>Reference</h3>
                    <ul>
                        <li><a href="/docs/commands.html">Command Reference</a></li>
                        <li><a href="/docs/troubleshooting.html">Troubleshooting</a></li>
                    </ul>
                </div>

                <div class="docs-nav-section">
                    <h3>Guides</h3>
                    <ul>
                        <li><a href="/docs/guides/team-onboarding.html">Team Onboarding</a></li>
                        <li><a href="/docs/guides/offboarding.html">Team Offboarding</a></li>
                        <li><a href="/docs/guides/environments.html">Multiple Environments</a></li>
                        <li><a href="/docs/guides/ci-cd.html">CI/CD Integration</a></li>
                        <li><a href="/docs/guides/relay.html">Using the Relay</a></li>
                        <li><a href="/docs/guides/vscode.html">VS Code Extension</a></li>
                        <li><a href="/docs/guides/shell.html">Shell Integration</a></li>
                        <li><a href="/docs/guides/security.html" class="active">Security Best Practices</a></li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="docs-content">
            <article class="docs-article">
                <header class="docs-header">
                    <h1>Security Best Practices</h1>
                    <p class="docs-lead">Recommendations for keeping your secrets safe with envctl.</p>
                </header>

                <section class="docs-section">
                    <h2>Passphrase Strength</h2>

                    <p>Your passphrase protects your identity's private key. A weak passphrase undermines all other security measures.</p>

                    <h3>Recommendations</h3>

                    <ul>
                        <li><strong>Length:</strong> At least 16 characters, preferably 20+</li>
                        <li><strong>Type:</strong> Use a passphrase (multiple words) rather than a password</li>
                        <li><strong>Uniqueness:</strong> Don't reuse from other services</li>
                        <li><strong>Storage:</strong> Use a password manager or system keychain</li>
                    </ul>

                    <h3>Examples</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Example</th>
                                <th>Strength</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Weak password</td>
                                <td><code>password123</code></td>
                                <td>Poor</td>
                            </tr>
                            <tr>
                                <td>Complex password</td>
                                <td><code>K#9mP!x2Qa</code></td>
                                <td>Medium</td>
                            </tr>
                            <tr>
                                <td>Passphrase</td>
                                <td><code>correct horse battery staple</code></td>
                                <td>Good</td>
                            </tr>
                            <tr>
                                <td>Long passphrase</td>
                                <td><code>my cat enjoys sleeping on keyboards daily</code></td>
                                <td>Excellent</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Using the System Keychain</h3>

                    <p>Store your passphrase in the system keychain for convenience without sacrificing security:</p>

                    <pre><code><span class="prompt">$</span> envctl init --keychain</code></pre>

                    <p>The keychain is protected by your system login, so you don't need to enter the passphrase repeatedly.</p>
                </section>

                <section class="docs-section">
                    <h2>Hardware Security (YubiKey)</h2>

                    <p>For maximum security, store your private key on a YubiKey:</p>

                    <pre><code><span class="prompt">$</span> envctl init --yubikey</code></pre>

                    <p>Benefits:</p>
                    <ul>
                        <li>Private key never leaves the hardware device</li>
                        <li>Signing operations happen on the YubiKey</li>
                        <li>Even if your machine is compromised, the key is safe</li>
                        <li>Physical presence required to use the key</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Regular Rotation</h2>

                    <p>Rotate secrets periodically, not just when someone leaves.</p>

                    <h3>Suggested Schedule</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>Secret Type</th>
                                <th>Rotation Frequency</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>API keys (third-party)</td>
                                <td>Quarterly</td>
                            </tr>
                            <tr>
                                <td>Database passwords</td>
                                <td>Quarterly</td>
                            </tr>
                            <tr>
                                <td>Service account keys</td>
                                <td>Quarterly</td>
                            </tr>
                            <tr>
                                <td>CI private key</td>
                                <td>Annually</td>
                            </tr>
                            <tr>
                                <td>Your identity key</td>
                                <td>Annually (or if compromised)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>After Team Changes</h3>

                    <p>Always rotate when:</p>
                    <ul>
                        <li>A team member leaves</li>
                        <li>A contractor's engagement ends</li>
                        <li>Access is revoked for any reason</li>
                    </ul>

                    <p>See the <a href="/docs/guides/offboarding.html">Offboarding guide</a> for details.</p>
                </section>

                <section class="docs-section">
                    <h2>Principle of Least Privilege</h2>

                    <p>Give team members access only to what they need.</p>

                    <h3>Environment Access</h3>

                    <pre><code><span class="dim"># New developers: dev only</span>
<span class="prompt">$</span> envctl project invite newdev --pubkey ... --env dev

<span class="dim"># After onboarding: add staging</span>
<span class="prompt">$</span> envctl project grant newdev --env staging

<span class="dim"># Only when needed: add prod</span>
<span class="prompt">$</span> envctl project grant newdev --env prod</code></pre>

                    <h3>Roles</h3>

                    <ul>
                        <li><strong>reader</strong> — For people who need to view but not modify (auditors, support)</li>
                        <li><strong>member</strong> — For developers who modify secrets</li>
                        <li><strong>admin</strong> — For team leads who manage membership</li>
                    </ul>

                    <h3>Production Access</h3>

                    <p>Limit production access to essential personnel:</p>
                    <ul>
                        <li>Most developers don't need prod secrets for daily work</li>
                        <li>Use staging for development and testing</li>
                        <li>Grant prod access temporarily for deployments</li>
                        <li>Review prod access regularly</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Backup and Recovery</h2>

                    <h3>Paper Backup</h3>

                    <p>Export your identity as a paper backup:</p>

                    <pre><code><span class="prompt">$</span> envctl identity export
Passphrase:

Your recovery phrase (24 words):

  1. apple      7. grape     13. mango     19. strawberry
  2. banana     8. honeydew  14. nectarine 20. tangerine
  3. cherry     9. kiwi      15. orange    21. ugli
  4. date      10. lemon     16. papaya    22. vanilla
  5. elderberry 11. lime     17. quince    23. watermelon
  6. fig       12. melon     18. raspberry 24. xigua

Write these words on paper and store in a secure location.
Do NOT store digitally or take a screenshot.</code></pre>

                    <p>Store this in a secure physical location (safe, safety deposit box).</p>

                    <h3>Recovery</h3>

                    <pre><code><span class="prompt">$</span> envctl identity recover
Enter your 24-word recovery phrase:
<span class="dim">Word 1:</span> apple
<span class="dim">Word 2:</span> banana
...
<span class="success">✓</span> Identity recovered</code></pre>

                    <h3>What You Can't Recover</h3>

                    <ul>
                        <li><strong>Project membership</strong> — You'll need to be re-invited</li>
                        <li><strong>Local .env files</strong> — Re-export from envctl after recovery</li>
                        <li><strong>CI private keys</strong> — Generate new ones if lost</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Compromised Machine Response</h2>

                    <p>If you suspect a machine is compromised:</p>

                    <h3>Immediate Actions</h3>

                    <ol>
                        <li><strong>Rotate your identity key:</strong>
                            <pre><code><span class="prompt">$</span> envctl identity rotate-key
<span class="warning">!</span> This will re-encrypt all secrets you have access to.
<span class="warning">!</span> Other team members will need to approve the new key.
Continue? [y/N] y</code></pre>
                        </li>
                        <li><strong>Notify your team</strong> — Others should be aware</li>
                        <li><strong>Rotate secrets you had access to</strong> — Starting with production</li>
                        <li><strong>Re-export CI bundles</strong> — If the CI key was accessible</li>
                    </ol>

                    <h3>If a Team Member's Machine is Compromised</h3>

                    <ol>
                        <li><strong>Remove them from the project:</strong>
                            <pre><code><span class="prompt">$</span> envctl project remove compromised-user --reason "Security incident"</code></pre>
                        </li>
                        <li><strong>Rotate all secrets they had access to</strong></li>
                        <li><strong>Review audit logs for suspicious activity:</strong>
                            <pre><code><span class="prompt">$</span> envctl log --search compromised-user --since 30d</code></pre>
                        </li>
                        <li><strong>Re-invite them with a new identity</strong> after they've secured their machine</li>
                    </ol>
                </section>

                <section class="docs-section">
                    <h2>Audit and Monitoring</h2>

                    <h3>Regular Audits</h3>

                    <p>Periodically review:</p>

                    <ul>
                        <li><strong>Team membership:</strong> Who has access?
                            <pre><code><span class="prompt">$</span> envctl project members</code></pre>
                        </li>
                        <li><strong>Environment access:</strong> Who can see production?
                            <pre><code><span class="prompt">$</span> envctl project access --env prod</code></pre>
                        </li>
                        <li><strong>Recent changes:</strong> What's been modified?
                            <pre><code><span class="prompt">$</span> envctl log --since 30d</code></pre>
                        </li>
                    </ul>

                    <h3>Suspicious Activity</h3>

                    <p>Watch for:</p>
                    <ul>
                        <li>Unexpected secret changes</li>
                        <li>Access from unusual locations (check relay logs)</li>
                        <li>Failed authentication attempts</li>
                        <li>Bulk secret exports</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Encryption Overview</h2>

                    <p>envctl uses strong, modern cryptography:</p>

                    <table>
                        <thead>
                            <tr>
                                <th>Purpose</th>
                                <th>Algorithm</th>
                                <th>Security Level</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Key encapsulation</td>
                                <td>ML-KEM-768</td>
                                <td>Post-quantum (192-bit)</td>
                            </tr>
                            <tr>
                                <td>Symmetric encryption</td>
                                <td>AES-256-GCM</td>
                                <td>256-bit</td>
                            </tr>
                            <tr>
                                <td>Signatures</td>
                                <td>Ed25519</td>
                                <td>128-bit</td>
                            </tr>
                            <tr>
                                <td>Passphrase hashing</td>
                                <td>Argon2id</td>
                                <td>Memory-hard</td>
                            </tr>
                            <tr>
                                <td>Transport</td>
                                <td>TLS 1.3</td>
                                <td>256-bit</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>The post-quantum encryption (ML-KEM-768) protects your secrets against future quantum computer attacks.</p>
                </section>

                <section class="docs-section">
                    <h2>Security Checklist</h2>

                    <ul>
                        <li>Use a strong passphrase (16+ characters)</li>
                        <li>Consider YubiKey for high-security environments</li>
                        <li>Create and store a paper backup</li>
                        <li>Limit production access to essential personnel</li>
                        <li>Rotate secrets quarterly</li>
                        <li>Rotate immediately when team members leave</li>
                        <li>Review access lists monthly</li>
                        <li>Keep envctl updated for security patches</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Related</h2>

                    <ul>
                        <li><a href="/docs/concepts.html#encryption">Core Concepts: Encryption Model</a></li>
                        <li><a href="/docs/guides/offboarding.html">Team Offboarding</a></li>
                        <li><a href="/docs/guides/environments.html">Multiple Environments</a></li>
                    </ul>
                </section>
            </article>
        </main>
    </div>

    <footer class="footer" role="contentinfo">
        <div class="footer-content">
            <div class="footer-links">
                <a href="https://github.com/uradical/envctl" target="_blank" rel="noopener">GitHub</a>
                <a href="https://github.com/uradical/envctl/issues" target="_blank" rel="noopener">Issues</a>
                <a href="https://github.com/uradical/envctl/blob/main/LICENSE" target="_blank" rel="noopener">License</a>
            </div>
            <div class="footer-copy">
                <p>© 2026 uRadical.</p>
            </div>
        </div>
    </footer>
    <script src="/docs/mobile-nav.js"></script>
</body>
</html>
