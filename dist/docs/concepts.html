<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>Core Concepts — envctl Documentation</title>
    <meta name="title" content="Core Concepts — envctl Documentation">
    <meta name="description" content="Understand how envctl works: identities, projects, environments, the ops chain, encryption model, and relay servers.">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://envctl.dev/docs/concepts.html">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://envctl.dev/docs/concepts.html">
    <meta property="og:title" content="Core Concepts — envctl Documentation">
    <meta property="og:description" content="Understand how envctl works under the hood.">
    <meta property="og:image" content="https://envctl.dev/og-image.png">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/assets/logo-UeMDaNQG.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">

    <!-- Theme -->
    <meta name="theme-color" content="#0a0a0b">
    <meta name="color-scheme" content="dark">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@400;500;600&display=swap">

    <link rel="stylesheet" href="/docs/docs.css">
  <link rel="stylesheet" crossorigin href="/assets/style-BhBew_en.css">
</head>
<body>
    <nav class="nav" role="navigation" aria-label="Main navigation">
        <a href="/" class="nav-logo" aria-label="envctl home">
            <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2032%2032'%20fill='none'%3e%3c!--%20Background%20circle%20--%3e%3ccircle%20cx='16'%20cy='16'%20r='15'%20stroke='%2322c55e'%20stroke-width='1.5'%20fill='none'/%3e%3c!--%20Lock%20body%20--%3e%3crect%20x='10'%20y='14'%20width='12'%20height='10'%20rx='2'%20fill='%2322c55e'/%3e%3c!--%20Lock%20shackle%20--%3e%3cpath%20d='M12%2014V11a4%204%200%200%201%208%200v3'%20stroke='%2322c55e'%20stroke-width='1.5'%20fill='none'%20stroke-linecap='round'/%3e%3c!--%20Keyhole%20--%3e%3ccircle%20cx='16'%20cy='18'%20r='1.5'%20fill='%230a0a0b'/%3e%3crect%20x='15'%20y='18'%20width='2'%20height='3'%20fill='%230a0a0b'/%3e%3c/svg%3e" alt="" width="32" height="32" aria-hidden="true">
            <span>envctl</span>
        </a>
        <div class="nav-links">
            <a href="/#features">Features</a>
            <a href="/#install">Install</a>
            <a href="/docs/" class="active">Docs</a>
            <a href="/#pricing">Pricing</a>
            <a href="https://github.com/uradical/envctl" class="nav-github" target="_blank" rel="noopener" aria-label="View on GitHub">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
        </div>
    </nav>

    <div class="docs-layout">
        <aside class="docs-sidebar">
            <nav class="docs-nav">
                <div class="docs-nav-section">
                    <h3>Getting Started</h3>
                    <ul>
                        <li><a href="/docs/">Documentation Home</a></li>
                        <li><a href="/docs/getting-started.html">Installation & Setup</a></li>
                        <li><a href="/docs/concepts.html" class="active">Core Concepts</a></li>
                    </ul>
                </div>

                <div class="docs-nav-section">
                    <h3>Reference</h3>
                    <ul>
                        <li><a href="/docs/commands.html">Command Reference</a></li>
                        <li><a href="/docs/troubleshooting.html">Troubleshooting</a></li>
                    </ul>
                </div>

                <div class="docs-nav-section">
                    <h3>Guides</h3>
                    <ul>
                        <li><a href="/docs/guides/team-onboarding.html">Team Onboarding</a></li>
                        <li><a href="/docs/guides/offboarding.html">Team Offboarding</a></li>
                        <li><a href="/docs/guides/environments.html">Multiple Environments</a></li>
                        <li><a href="/docs/guides/ci-cd.html">CI/CD Integration</a></li>
                        <li><a href="/docs/guides/relay.html">Using the Relay</a></li>
                        <li><a href="/docs/guides/vscode.html">VS Code Extension</a></li>
                        <li><a href="/docs/guides/security.html">Security Best Practices</a></li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="docs-content">
            <article class="docs-article">
                <header class="docs-header">
                    <h1>Core Concepts</h1>
                    <p class="docs-lead">Understanding how envctl works will help you use it effectively. This page covers the fundamental concepts: identities, projects, environments, sync, and encryption.</p>
                </header>

                <section class="docs-section">
                    <h2>Identity and Keypairs</h2>

                    <p>Your <strong>identity</strong> is how envctl knows who you are. When you run <code>envctl init</code>, it generates a cryptographic keypair:</p>

                    <ul>
                        <li><strong>Private key</strong> — Encrypted with your passphrase, stored locally. Never leaves your machine.</li>
                        <li><strong>Public key</strong> — Shared with teammates so they can encrypt secrets for you.</li>
                    </ul>

                    <p>Your identity is identified by a <strong>fingerprint</strong>—a hash of your public key:</p>

                    <pre><code><span class="prompt">$</span> envctl whoami
Name: alice-macbook
Fingerprint: sha256:7f3a9b2c4d5e6f7a...</code></pre>

                    <p>This fingerprint is used to verify that you're communicating with the right person. When you invite someone to a project, you share their fingerprint to confirm their identity.</p>

                    <h3>Where Keys Are Stored</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>File</th>
                                <th>Contents</th>
                                <th>Sensitive?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>~/.config/envctl/identity.enc</code></td>
                                <td>Encrypted private key</td>
                                <td>Yes (encrypted)</td>
                            </tr>
                            <tr>
                                <td><code>~/.config/envctl/identity.pub</code></td>
                                <td>Public key</td>
                                <td>No (shareable)</td>
                            </tr>
                            <tr>
                                <td><code>~/.config/envctl/identity.json</code></td>
                                <td>Metadata (name, created date)</td>
                                <td>No</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Hardware-Backed Keys (YubiKey)</h3>

                    <p>For extra security, you can store your private key on a YubiKey. The key never leaves the hardware device—signing operations happen on the YubiKey itself.</p>

                    <pre><code><span class="prompt">$</span> envctl init --yubikey</code></pre>
                </section>

                <section class="docs-section">
                    <h2>Projects</h2>

                    <p>A <strong>project</strong> is a collection of secrets and the team members who have access to them. Projects are typically associated with a codebase or service.</p>

                    <pre><code><span class="prompt">$</span> envctl project create myapp</code></pre>

                    <p>Each project has:</p>
                    <ul>
                        <li><strong>A name</strong> — Identifies the project (e.g., "myapp", "backend-api")</li>
                        <li><strong>Members</strong> — The people who can access secrets</li>
                        <li><strong>Environments</strong> — Separate sets of secrets (dev, staging, prod)</li>
                        <li><strong>A membership chain</strong> — Cryptographic record of who joined, left, and what access they have</li>
                    </ul>

                    <h3>Project Directory</h3>

                    <p>When you create or link a project, envctl creates a <code>.envctl/</code> directory:</p>

                    <pre><code>myapp/
├── .envctl/
│   ├── config           # Project settings
│   ├── dev.enc          # Encrypted dev secrets
│   ├── staging.enc      # Encrypted staging secrets
│   └── prod.enc         # Encrypted prod secrets
├── src/
└── package.json</code></pre>

                    <p>The <code>.envctl/</code> directory can be committed to git—the secrets are encrypted. This enables GitOps workflows where your CI can decrypt secrets from the repository.</p>
                </section>

                <section class="docs-section">
                    <h2>Environments</h2>

                    <p><strong>Environments</strong> are separate namespaces for secrets within a project. By default, projects have three environments:</p>

                    <ul>
                        <li><strong>dev</strong> — Local development</li>
                        <li><strong>staging</strong> — Testing and QA</li>
                        <li><strong>prod</strong> — Production</li>
                    </ul>

                    <p>Each environment has its own set of secrets and its own access control. A team member might have access to dev and staging, but not prod.</p>

                    <pre><code><span class="prompt">$</span> envctl env list
<span class="dim">Environments for myapp:</span>

* dev          (3 members)
  staging      (2 members)
  prod         (1 member)</code></pre>

                    <p>The asterisk (*) shows your current environment. Use <code>envctl env use &lt;name&gt;</code> to switch.</p>

                    <h3>Environment-Based Access Control</h3>

                    <p>Access is granted per-environment:</p>

                    <pre><code><span class="dim"># Grant access to dev and staging</span>
<span class="prompt">$</span> envctl project grant bob --env dev,staging

<span class="dim"># Later, grant prod access</span>
<span class="prompt">$</span> envctl project grant bob --env prod</code></pre>

                    <p>This allows you to follow the principle of least privilege—developers get dev access by default, and prod access is granted only when necessary.</p>
                </section>

                <section class="docs-section">
                    <h2>The Ops Chain (How Sync Works)</h2>

                    <p>envctl uses an <strong>ops chain</strong> to track changes to secrets. Think of it like a git log for your environment variables—every change is recorded as an operation.</p>

                    <h3>What's in an Operation?</h3>

                    <p>Each operation contains:</p>
                    <ul>
                        <li><strong>Type</strong> — What happened (set, delete, etc.)</li>
                        <li><strong>Key</strong> — Which variable was affected</li>
                        <li><strong>Value</strong> — The new value (encrypted)</li>
                        <li><strong>Timestamp</strong> — When it happened</li>
                        <li><strong>Author</strong> — Who made the change (signed)</li>
                        <li><strong>Previous hash</strong> — Links to the previous operation</li>
                    </ul>

                    <p>Operations are cryptographically signed and hash-linked. You can't tamper with history without invalidating all subsequent operations.</p>

                    <h3>How Sync Works</h3>

                    <ol>
                        <li>You make a change: <code>envctl env var set API_KEY=secret</code></li>
                        <li>envctl creates an operation, signs it with your key, and adds it to your local chain</li>
                        <li>The daemon broadcasts the operation to connected peers</li>
                        <li>Peers verify your signature and apply the operation to their chain</li>
                        <li>Peers re-broadcast to their peers (if not already seen)</li>
                    </ol>

                    <p>This is eventually consistent—all peers will converge to the same state, but there might be brief delays during sync.</p>

                    <h3>Conflict Resolution</h3>

                    <p>If two people set the same variable at the same time, both operations are recorded. The "winner" is determined by timestamp (last write wins), but both operations remain in the chain for audit purposes.</p>
                </section>

                <section class="docs-section">
                    <h2>Encryption Model</h2>

                    <p>envctl uses a hybrid encryption scheme designed for post-quantum security:</p>

                    <h3>Algorithms</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>Purpose</th>
                                <th>Algorithm</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Key encapsulation</td>
                                <td>ML-KEM-768</td>
                                <td>Post-quantum secure (FIPS 203)</td>
                            </tr>
                            <tr>
                                <td>Symmetric encryption</td>
                                <td>AES-256-GCM</td>
                                <td>Authenticated encryption</td>
                            </tr>
                            <tr>
                                <td>Signatures</td>
                                <td>Ed25519</td>
                                <td>Fast, compact signatures</td>
                            </tr>
                            <tr>
                                <td>Key derivation (passphrase)</td>
                                <td>Argon2id</td>
                                <td>Memory-hard password hashing</td>
                            </tr>
                            <tr>
                                <td>Key derivation (keys)</td>
                                <td>HKDF-SHA256</td>
                                <td>Derives AES key from shared secret</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>How Secret Encryption Works</h3>

                    <p>When you set a secret:</p>

                    <ol>
                        <li>envctl generates a random AES-256 key for this operation</li>
                        <li>The secret value is encrypted with AES-256-GCM</li>
                        <li>The AES key is encapsulated using ML-KEM for each recipient</li>
                        <li>The operation is signed with your Ed25519 key</li>
                    </ol>

                    <p>Each team member receives a copy of the AES key, encrypted to their public key. Only recipients can decrypt the secret.</p>

                    <h3>Identity Key Encryption</h3>

                    <p>Your private key is encrypted at rest:</p>

                    <ol>
                        <li>Your passphrase is fed through Argon2id with a random salt</li>
                        <li>The derived key encrypts your private key with AES-256-GCM</li>
                        <li>The encrypted key and salt are stored in <code>identity.enc</code></li>
                    </ol>

                    <p>Without your passphrase, your private key cannot be recovered.</p>
                </section>

                <section class="docs-section">
                    <h2>Relay Servers</h2>

                    <p>The <strong>relay</strong> is an optional server that enables async sync. It's useful when:</p>

                    <ul>
                        <li>Team members are in different time zones and rarely online together</li>
                        <li>You're working from different networks (no direct P2P possible)</li>
                        <li>You want guaranteed delivery even when peers are offline</li>
                    </ul>

                    <h3>What the Relay Sees</h3>

                    <table>
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Visible to Relay?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Secret values</td>
                                <td>No (encrypted)</td>
                            </tr>
                            <tr>
                                <td>Secret keys (variable names)</td>
                                <td>No (encrypted)</td>
                            </tr>
                            <tr>
                                <td>Who is syncing</td>
                                <td>Yes (IP addresses, timing)</td>
                            </tr>
                            <tr>
                                <td>Message sizes</td>
                                <td>Yes</td>
                            </tr>
                            <tr>
                                <td>Project/team identifiers</td>
                                <td>Yes (for routing)</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>The relay is a store-and-forward service. It holds encrypted messages until recipients come online to collect them. It cannot read your secrets.</p>

                    <h3>Enabling the Relay</h3>

                    <pre><code><span class="prompt">$</span> envctl project relay set relay.envctl.dev
<span class="success">✓</span> Relay configured for myapp</code></pre>

                    <p>See the <a href="/docs/guides/relay.html">Relay guide</a> for more details.</p>
                </section>

                <section class="docs-section">
                    <h2>The Daemon</h2>

                    <p>The <strong>daemon</strong> is a background process that handles P2P networking and sync. It:</p>

                    <ul>
                        <li>Listens for incoming peer connections</li>
                        <li>Discovers peers on the local network via mDNS</li>
                        <li>Maintains connections to the relay (if configured)</li>
                        <li>Broadcasts changes when you modify secrets</li>
                        <li>Applies incoming changes from peers</li>
                    </ul>

                    <pre><code><span class="prompt">$</span> envctl daemon start
<span class="success">✓</span> Daemon started
  P2P port: 7834
  Web UI: http://localhost:7835</code></pre>

                    <p>The daemon is optional for local-only use. If you're only using secrets on one machine without syncing, you don't need to run it.</p>

                    <h3>Daemon vs. CLI</h3>

                    <p>Most commands work without the daemon running:</p>

                    <table>
                        <thead>
                            <tr>
                                <th>Feature</th>
                                <th>Daemon Required?</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Set/get secrets locally</td>
                                <td>No</td>
                            </tr>
                            <tr>
                                <td>Export .env file</td>
                                <td>No</td>
                            </tr>
                            <tr>
                                <td>CI bundle operations</td>
                                <td>No</td>
                            </tr>
                            <tr>
                                <td>Sync with peers</td>
                                <td>Yes</td>
                            </tr>
                            <tr>
                                <td>Relay connection</td>
                                <td>Yes</td>
                            </tr>
                            <tr>
                                <td>Web UI</td>
                                <td>Yes</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <section class="docs-section">
                    <h2>Membership Chain</h2>

                    <p>In addition to the ops chain (for secrets), each project has a <strong>membership chain</strong> that tracks:</p>

                    <ul>
                        <li>Who created the project</li>
                        <li>Who was invited and when</li>
                        <li>Who was removed and why</li>
                        <li>Access level changes</li>
                        <li>Environment access grants/revocations</li>
                    </ul>

                    <p>This chain is also cryptographically signed and immutable. You can audit membership history:</p>

                    <pre><code><span class="prompt">$</span> envctl project log
2024-03-01 16:00  alice  Removed bob (reason: Left company)
2024-02-15 11:30  alice  Granted bob reader access to prod
2024-01-20 14:00  alice  Added charlie (member)
2024-01-10 09:00  alice  Added bob (member)
2024-01-05 10:00  alice  Created project myapp</code></pre>
                </section>

                <section class="docs-section">
                    <h2>Summary</h2>

                    <ul>
                        <li><strong>Identity</strong> — Your cryptographic keypair, protected by a passphrase</li>
                        <li><strong>Project</strong> — A collection of secrets and team members</li>
                        <li><strong>Environment</strong> — A namespace for secrets (dev, staging, prod)</li>
                        <li><strong>Ops chain</strong> — Append-only log of all secret changes</li>
                        <li><strong>Membership chain</strong> — Append-only log of team changes</li>
                        <li><strong>Relay</strong> — Optional server for async sync</li>
                        <li><strong>Daemon</strong> — Background process for P2P networking</li>
                    </ul>
                </section>

                <section class="docs-section">
                    <h2>Next Steps</h2>

                    <ul>
                        <li><a href="/docs/commands.html">Command Reference</a> — Full list of all commands</li>
                        <li><a href="/docs/guides/security.html">Security Best Practices</a> — Recommendations for secure usage</li>
                        <li><a href="/docs/guides/environments.html">Multiple Environments</a> — Managing dev, staging, and prod</li>
                    </ul>
                </section>
            </article>
        </main>
    </div>

    <footer class="footer" role="contentinfo">
        <div class="footer-content">
            <div class="footer-links">
                <a href="https://github.com/uradical/envctl" target="_blank" rel="noopener">GitHub</a>
                <a href="https://github.com/uradical/envctl/issues" target="_blank" rel="noopener">Issues</a>
                <a href="https://github.com/uradical/envctl/blob/main/LICENSE" target="_blank" rel="noopener">License</a>
            </div>
            <div class="footer-copy">
                <p>© 2026 uRadical.</p>
            </div>
        </div>
    </footer>
</body>
</html>
